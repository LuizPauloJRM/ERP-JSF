<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Lançamentos</title>
</h:head>

<h:body>

    <h:form id="formLanc">

        <!-- Título -->
        <p:panel header="Gerenciamento de Lançamentos" style="margin:20px;">

            <!-- Botão novo -->
            <p:commandButton value="Novo Lançamento" icon="pi pi-plus"
                             oncomplete="PF('dlgLancamento').show();"
                             update=":formDlg" />

            <p:separator/>
            
            <!-- LISTAGEM -->
            <p:dataTable id="tabelaLanc" value="#{lancamentoBean.lancamentos}"
                         var="lancamento" paginator="true" rows="10"
                         emptyMessage="Nenhum lançamento encontrado">

                <p:column headerText="ID" style="width:60px;">
                    #{l.id}
                </p:column>

                <p:column headerText="Descrição">
                    #{l.descricao}
                </p:column>

                <p:column headerText="Valor">
                    <h:outputText value="#{lancamento.valor}">
                        <f:convertNumber type="currency" currencySymbol="R$ " />
                    </h:outputText>
                </p:column>

                <p:column headerText="Data">
                    <h:outputText value="#{lancamento.data}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>
                </p:column>

                <p:column headerText="Tipo">
                    <h:outputText value="#{lancamento.tipo eq 'E' ? 'Entrada' : 'Saída'}" />
                </p:column>

                <p:column headerText="Ações" style="width:150px;">
                    <p:commandButton icon="pi pi-pencil" title="Editar"
                                     update=":formDlg"
                                     actionListener="#{lancamentoBean.editar(l)}"
                                     oncomplete="PF('dlgLancamento').show();" />

                    <p:commandButton icon="pi pi-trash" title="Excluir"
                                     actionListener="#{lancamentoBean.excluir(l)}"
                                     update="tabelaLanc"
                                     style="margin-left:5px;"
                                     onclick="return confirm('Deseja excluir?');" />
                </p:column>

            </p:dataTable>
        </p:panel>
    </h:form>

    <!-- DIALOG CADASTRO -->
    <p:dialog widgetVar="dlgLancamento" header="Cadastro de Lançamento"
              modal="true" resizable="false" width="500">

        <h:form id="formDlg">
            <p:panelGrid columns="2" columnClasses="label, field" style="width:100%;">

                <p:outputLabel value="Descrição:" for="descricao" />
                <p:inputText id="descricao" value="#{lancamentoBean.lancamento.descricao}" required="true"/>

                <p:outputLabel value="Valor:" for="valor" />
                <p:inputNumber id="valor" value="#{lancamentoBean.lancamento.valor}"
                               required="true" decimalPlaces="2"/>

                <p:outputLabel value="Data:" for="data" />
                <p:datePicker id="data" value="#{lancamentoBean.lancamento.data}"
                              pattern="dd/MM/yyyy" />

                <p:outputLabel value="Tipo:" for="tipo" />
                <p:selectOneMenu id="tipo" value="#{lancamentoBean.lancamento.tipo}">
                    <f:selectItem itemLabel="Entrada" itemValue="E" />
                    <f:selectItem itemLabel="Saída" itemValue="S" />
                </p:selectOneMenu>

            </p:panelGrid>

            <p:separator/>

            <p:commandButton value="Salvar" icon="pi pi-check"
                             actionListener="#{lancamentoBean.salvar}"
                             update=":formLanc:tabelaLanc"
                             oncomplete="PF('dlgLancamento').hide();" />

            <p:commandButton value="Cancelar" icon="pi pi-times"
                             onclick="PF('dlgLancamento').hide(); return false;" />
        </h:form>

    </p:dialog>

</h:body>
</html>
